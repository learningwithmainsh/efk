# EFK Stack (Elasticsearch, Fluentd, Kibana)

The EFK stack (Elasticsearch, Fluentd, Kibana) is a popular logging and monitoring solution used to collect, process, store, and visualize log data from various sources.

## Table of Contents
- [Overview](#overview)
- [Components](#components)
  - [Elasticsearch](#elasticsearch)
  - [Fluentd](#fluentd)
  - [Kibana](#kibana)
- [Prerequisites](#prerequisites)
- [Installation](#installation)
  - [Deploying with Docker](#deploying-with-docker)
  - [Deploying on Kubernetes](#deploying-on-kubernetes)
- [Configuration](#configuration)
- [Usage](#usage)
- [Security Considerations](#security-considerations)
- [Troubleshooting](#troubleshooting)
- [Conclusion](#conclusion)

## Overview
The EFK stack provides a centralized logging solution for analyzing logs generated by various applications, containers, and infrastructure components. Fluentd collects and forwards logs, Elasticsearch stores them efficiently, and Kibana provides visualization and search capabilities.

## Components
### Elasticsearch
- A distributed search and analytics engine.
- Stores and indexes log data for fast searching and retrieval.
- Provides powerful querying capabilities via the Elasticsearch Query DSL.

### Fluentd
- A log processor and forwarder.
- Collects logs from multiple sources, processes them, and forwards them to Elasticsearch.
- Supports various plugins for data transformation and filtering.

### Kibana
- A web-based visualization tool for Elasticsearch data.
- Provides dashboards, charts, and graphs for log analysis.
- Enables full-text search and filtering.

## Prerequisites
- Docker and Docker Compose (for a containerized setup) or Kubernetes (for a cloud-native setup).
- At least 4GB RAM and 2 CPUs for local testing.
- Open ports:
  - 9200 (Elasticsearch)
  - 5601 (Kibana)
  - 24224 (Fluentd, if using TCP input)

## Installation
### Deploying with Docker
Create a `docker-compose.yml` file:
```yaml
version: '3'
services:
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:7.17.3
    environment:
      - discovery.type=single-node
    ports:
      - "9200:9200"
  
  kibana:
    image: docker.elastic.co/kibana/kibana:7.17.3
    ports:
      - "5601:5601"
    depends_on:
      - elasticsearch
  
  fluentd:
    image: fluent/fluentd:v1.14
    volumes:
      - ./fluentd.conf:/fluentd/etc/fluentd.conf
    ports:
      - "24224:24224"
```
Run the stack:
```sh
docker-compose up -d
```

### Deploying on Kubernetes
Apply the following manifest:
```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: efk-stack
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: elasticsearch
  namespace: efk-stack
spec:
  replicas: 1
  selector:
    matchLabels:
      app: elasticsearch
  template:
    metadata:
      labels:
        app: elasticsearch
    spec:
      containers:
      - name: elasticsearch
        image: docker.elastic.co/elasticsearch/elasticsearch:7.17.3
        env:
          - name: discovery.type
            value: "single-node"
        ports:
        - containerPort: 9200
```
Apply the deployment:
```sh
kubectl apply -f efk-deployment.yaml
```

## Configuration
### Fluentd Config Example
```conf
<source>
  @type tail
  path /var/log/*.log
  pos_file /var/log/fluentd.pos
  tag app.logs
  format none
</source>

<match app.logs>
  @type elasticsearch
  host elasticsearch
  port 9200
  logstash_format true
</match>
```

## Usage
1. Open Kibana at `http://localhost:5601`
2. Configure an index pattern (e.g., `logstash-*`).
3. Explore logs and create visualizations.

## Security Considerations
- Enable authentication and role-based access in Elasticsearch.
- Use HTTPS for secure communication.
- Set resource limits to prevent memory overuse.

## Troubleshooting
- Check logs using `docker logs` or `kubectl logs`.
- Verify Elasticsearch health: `curl http://localhost:9200/_cluster/health?pretty`.
- Ensure Fluentd has the correct permissions to read logs.

## Conclusion
The EFK stack is a powerful solution for log management. Proper setup and tuning help in efficiently collecting, storing, and analyzing logs.

# Author ðŸ‘¤
Created by Manish Pandey. Feel free to reach out for any queries or collaborations!

- [LinkedIn](https://www.linkedin.com/in/learningwithmanish)
- [WhatsApp](https://wa.me/918765368754)
- [Skype](live:.cid.16ae1ff3196c4f4e)
- [Medium](https://medium.com/@mnshkmrpnd)
- [Threads](https://www.threads.net/@learningwithmanish)
- [Instagram](https://www.instagram.com/learningwithmanish/?hl=en)
- [Facebook](https://www.facebook.com/pandey.manish.106)
- [DockerHub](https://hub.docker.com/u/manishgenius)